% This file contains the implementation of the rules for formatting the front of a 
% nanotechnology engineering workterm report.

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{frontmatter}[2016/04/11]
\RequirePackage{environ}
\RequirePackage{titletoc}
\RequirePackage{setspace}

\renewcommand{\contentsname}{Table of Contents}

\newenvironment{frontmatter}{
		
	\maketitlepage
	
	% Environment for the letter of submittal
	\NewEnviron{letter_of_submittal}[2]{
        
		\newgeometry{letterpage}
		\pagenumbering{gobble}
		
		\setlength{\parindent}{0cm}
		\setlength{\parskip}{1\baselineskip}

		\newpage
       
		\@employeraddress

		\vspace*{0pt}

		\today

		\vspace*{0pt}

		\@programdirector, Director \\
		\@program \\
		\@university \\
		\@universityaddress

		\vspace*{0pt}
		
		##1
		
		\vspace*{0pt}

		\BODY
		
		\vspace*{0pt}

		##2

		\vspace{1cm}

		\@author \\
		\@studentnumber

		\clearpage
		
		\restoregeometry
	
	}

	\NewEnviron{contributions}{
		
		\newpage
		\pagenumbering{roman}
		\setcounter{page}{3}
	
		\setstretch{1.5}
        		\setlength{\parindent}{0cm}
        		\setlength{\parskip}{1\baselineskip}

    		\addcontentsline{toc}{section}{Contributions}

    		\begin{section}*{Contributions}

    		\BODY

    		\end{section}
        		\clearpage
		
	}

	\NewEnviron{summary}{
	
		\newpage

		\setstretch{1.5}
		\setlength{\parindent}{0cm}
		\setlength{\parskip}{0.5\baselineskip}

		\addcontentsline{toc}{section}{Summary}
		
		\begin{section}*{Summary}

		\BODY

		\end{section}
		\clearpage

	}
	
	\NewEnviron{conclusions}{
		
		\newpage
		
		\setstretch{1.5}
		\setlength{\parindent}{0cm}
		\setlength{\parskip}{0.5\baselineskip}

		\addcontentsline{toc}{section}{Conclusions}

		\begin{section}*{Conclusions}

		\BODY

		\end{section}
		\clearpage

	}

	\NewEnviron{recommendations}{
		
		\newpage

		\setstretch{1.5}
		\setlength{\parindent}{0cm}
		\setlength{\parskip}{0.5\baselineskip}

		\addcontentsline{toc}{section}{Recommendations}

		\begin{section}*{Recommendations}

		\BODY

		\end{section}
		\clearpage
		\setcounter{pagenumber}{\arabic{page}}
		
	}

}


\newcommand{\maketitlepage}{

\newpage

\begin{titlepage}

	\newgeometry{letterpage}
	
	\centering

	{\LARGE  \@university \par}
	{\LARGE Faculty of \@faculty \par}
	\vspace{0.2cm}
	Department of \@program \par

	\vfill

	{\huge \@title \par}

	\vfill

	{\Large \@employername \par}
	\@employeraddress \par

	\vfill

	Prepared by \@author \par
	ID \@studentnumber \par
	User ID \@studentid \par
	\@previousterm \hspace{1pt} \@program \par
	\today \par
	
	\restoregeometry

	\end{titlepage}
	\clearpage

}

\newcommand{\toctree}{

	\newpage
	
	\tableofcontents
	
	\clearpage
	
}

\newcommand{\listoffiguresandtables}{

	\newpage
	
	\addcontentsline{toc}{section}{List of Figures}
	\listoffigures
	
	\clearpage

	\newpage
	
	\addcontentsline{toc}{section}{List of Tables}
	\listoftables
	
	\clearpage

}

\endinput
