\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{frontmatter}[2016/04/11]
\RequirePackage{environ}
\RequirePackage{titletoc}

\renewcommand{\contentsname}{Table of Contents}

\newenvironment{frontmatter}{
    \maketitlepage

    \NewEnviron{letter_of_submittal}[2]{
        \setlength{\parindent}{0cm}
    	\setlength{\parskip}{1\baselineskip}

        \newpage
        \pagenumbering{gobble}
        \setcounter{pagenumber}{1}

        \@employeraddress

        \vspace*{1\baselineskip}

        \today

        \vspace*{1\baselineskip}

        \@programdirector, Director \\
        \@program \\
        \@university \\
        \@universityaddress

        \vspace*{1\baselineskip}

        ##1

        \vspace*{1\baselineskip}

        \BODY

        \vspace*{1\baselineskip}

        ##2

        \vspace{1cm}

        \@author \\
        \@studentnumber

        \clearpage

        \setcounter{pagenumber}{\arabic{page}}
    }

    \NewEnviron{contributions}{
        \newpage
        \pagenumbering{roman}
        \setcounter{page}{\thepagenumber}

        \linespread{1.3}
        \setlength{\parindent}{0cm}
        \setlength{\parskip}{1\baselineskip}

    	\addcontentsline{toc}{section}{Contributions}

    	\begin{section}*{Contributions}

    	\BODY

    	\end{section}
        \clearpage

        \setcounter{pagenumber}{\arabic{page}}
    }

    \NewEnviron{summary}{
        \newpage
        \pagenumbering{roman}
        \setcounter{page}{\thepagenumber}

        \setstretch{1.5}
        \setlength{\parindent}{0cm}
        \setlength{\parskip}{0.5\baselineskip}

        \addcontentsline{toc}{section}{Summary}

        \begin{section}*{Summary}

        \BODY

        \end{section}
        \clearpage

        \setcounter{pagenumber}{\arabic{page}}
    }

}{}


\newcommand{\maketitlepage}{

\begin{titlepage}

	\centering

	{\LARGE  \@university \par}
	{\LARGE Faculty of \@faculty \par}
	\vspace{0.2cm}
	Department of \@program \par

	\vfill

	{\huge \@title \par}

	\vfill

	{\Large \@employername \par}
	\@employeraddress \par

	\vfill

	Prepared by \par
	\@author \par
	ID \@studentnumber \par
	User ID \@studentid \par
	\@previousterm \hspace{1pt} \@program \par
	\today \par

\end{titlepage}

}

\newcommand{\toctree}{

    \pagenumbering{gobble}

    \setcounter{page}{\thepagenumber}

    \titlecontents{section}
    [0pt] % left margin
    {\vspace{2pt}} % above code
    {
   		\thecontentslabel\enspace
    } % numbered entry format
    {\hspace{4pt}\contentsmargin{0pt}} % un-numbered entry format
    {\titlerule*[.5pc]{.}\contentspage} % separator
    [] % below code

    \titlecontents{subsection}
    [10pt]
    {}
    {
    	\contentsmargin{10pt}
    	\thecontentslabel\enspace
   	} % numbered entry format
   	{\contentsmargin{0pt}} % un-numbered entry format
   	{\titlerule*[.5pc]{.}\contentspage} % separator
   	[] % below code


    \newpage
	\tableofcontents
	\clearpage

    \setcounter{pagenumber}{\arabic{page}}
}

\newcommand{\listoffiguresandtables}{
	\pagenumbering{roman}
    \setcounter{page}{\thepagenumber}

    \addcontentsline{toc}{section}{List of Figures}

	\newpage
	\listoffigures
	\clearpage

	\newpage

    \addcontentsline{toc}{section}{List of Tables}

	\listoftables
	\clearpage

    \setcounter{pagenumber}{\arabic{page}}

}

\endinput


\endinput
